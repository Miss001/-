# 基本架构
![image](https://github.com/user-attachments/assets/94eeff51-56ea-4887-95b9-5fd9e0b9b2db)

## 逻辑结构
一个Postgresql服务器运行在一个主机(host)上并且管理着一个database cluster。  
一个DataBase Cluster可以包括：多个Database、多个User、以及Database中的所有对象。
一个Database 可以有多个Schema（数据库中的命名空间），在数据库中创建的所有对象都是在Schema中创建，一个用户可以从同一个客户端连接中访问不同的Schema。不同的Schema中可以有多个同名的表、视图、索引等对象。当创建一个数据库时，会为其创建一个名为public的默认Schema。  
每个Database是相互独立的，彼此之间无法直接进行跨库关联查询，需要借助dblink或其他扩展。  
每个Database都有自己独立的表和索引文件，表和索引文件的大小限制为1 GB。   
每个表都有两个关联文件、后缀分别为 _fsm 和 _vm。它们称为可用空间映射和可见性映射。用于存储有关可用空间容量的信息、并可查看表文件中的每个页面   
索引只具有单个可用空间映射、而不具有可见性映射。   
所有数据库对象都由各自的OID在内部管理，其OID存储在pg_database中。  
表和索引也由各个OID管理，其OID存储在pg_class中。 
```
-- 数据库对应的oid
select * from pg_database ;
-- 表/索引等对应的oid
select * from pg_class  
```
![image](https://github.com/user-attachments/assets/f4840d02-10db-419b-81cc-708b384e5aa6)


## 物理结构
一个database cluster基本上就是作为基础目录(base directory)的一个目录：$PGDATA  
一个database是base子目录下的一个子目录。  
每一个表和索引在base子目录中保存在(至少)一个文件（索引和数据可以保存在一个物理文件中）。  

