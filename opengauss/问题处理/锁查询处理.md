```
SELECT
    pg_locks.pid,
    (select pg_database.datname from pg_database where pg_database.oid=pg_locks.database) as database_name,
    pg_locks.relation::regclass as object_name,
    pg_locks.locktype,
    pg_locks.mode,
    pg_locks.granted,
    pg_locks.virtualxid,
    pg_stat_activity.usename,
    pg_stat_activity.application_name,
    pg_stat_activity.client_addr,
    pg_stat_activity.query_start,
    pg_stat_activity.query,
    pg_stat_activity.waiting
FROM
    pg_locks
  JOIN
    pg_stat_activity ON pg_locks.pid = pg_stat_activity.pid ;
```
